@model PatientViewModel;
@inject UserManager<ApplicationUser> userManger;
@inject Microsoft.AspNetCore.Antiforgery.IAntiforgery antiforgery;
@{
    var applicationUser = await userManger.GetUserAsync(User) ?? new ApplicationUser();
    ViewData["Title"] = "Details";
}

@section Styles {
    <link rel="stylesheet" href="~/assets/Plugins/datatables/datatables.bundle.css" />
}
<div class="card mb-10">
    <div class="card-body pt-9 pb-0">
        <!--begin::Details-->
        <div class="d-flex flex-wrap flex-sm-nowrap mb-6">
            <!--begin::Image-->
            <div class="d-flex flex-center flex-shrink-0 bg-light rounded w-100px h-100px w-lg-150px h-lg-150px me-7 mb-4">
                @if (@Model.ProfilePicture != null)
                {
                    <img class="mw-50px mw-lg-75px patient-image" src="data:image /*;base64,@(Convert.ToBase64String(@Model.ProfilePicture))" alt="image" />
                }
                else
                {
                    <img class="mw-50px mw-lg-75px patient-image" src="~/assets/images/user.jpg" alt="image" />
                }
            </div>
            <!--end::Image-->
            <!--begin::Wrapper-->
            <div class="flex-grow-1">
                <!--begin::Head-->
                <div class="d-flex justify-content-between align-items-start flex-wrap mb-2">
                    <!--begin::Details-->
                    <div class="d-flex flex-column">
                        <!--begin::Status-->
                        <div class="d-flex align-items-center mb-1">
                            <a href="#" class="text-gray-800 text-hover-primary fs-2 fw-bold me-3 patient-name">@Model.FullName</a>
                            <span class="badge badge-light-success patient-type me-2">
                                @if(userManger.Users.Any(x => x.PatientId == Model.Id))
                                {
                                    <span>online patient</span>
                                }
                                else
                                {
                                    <span>offline patient</span>
                                }
                            </span>
                        </div>
                        <!--end::Status-->
                        <!--begin::Description-->
                        <div class="d-flex flex-wrap fw-semibold mb-4 fs-5 text-gray-500 patient-address">
                            @Model.Address
                        </div>
                        <!--end::Description-->
                    </div>
                    <!--end::Details-->
                    <!--begin::Actions-->
                    <div class="d-flex mb-4">

                        @if(await userManger.IsInRoleAsync(applicationUser , "User"))
                        {
                            <a href="javascript:;" class="btn btn-sm btn-secondary me-3 js-reserve-appointment" data-id="@applicationUser.PatientId">Make Appointment</a>
                        }
                        else
                        {
                            <a class="btn btn-sm btn-secondary me-3" asp-controller="Patients" asp-action="Index">Back to List</a>
                        }
                    </div>
                    <!--end::Actions-->
                </div>
                <!--end::Head-->
                <!--begin::Info-->
                <div class="d-flex flex-wrap justify-content-start">
                    <!--begin::Stats-->
                    <div class="d-flex flex-wrap">
                        <!--begin::Stat-->
                        <div class="border border-gray-300 border-dashed rounded min-w-125px py-3 px-4 me-6 mb-3">
                            <!--begin::Number-->
                            <div class="d-flex align-items-center">
                                <div class="fs-4 fw-bold patient-birthdate">@Model.BirthDate.ToShortDateString()</div>
                            </div>
                            <!--end::Number-->
                            <!--begin::Label-->
                            <div class="fw-semibold fs-6 text-gray-500">Birthdate</div>
                            <!--end::Label-->
                        </div>
                        <!--end::Stat-->
                        <!--begin::Stat-->
                        <div class="border border-gray-300 border-dashed rounded min-w-125px py-3 px-4 me-6 mb-3">
                            <!--begin::Number-->
                            <div class="d-flex align-items-center">
                                <i class="fa-solid fa-file-invoice-dollar text-success me-2"></i>
                                <div class="fs-4 fw-bold counted patient-payments" data-kt-countup="true" data-kt-countup-value=@Model.GainPayment data-kt-initialized="1">
                                    @if(@Model.GainPayment > 0)
                                    {
                                        <span id="GainPayment">@Model.GainPayment</span><span class="ms-2">LE</span>
                                    }
                                    else
                                    {
                                        <span id="GainPayment">0</span>

                                        <span class="ms-2">LE</span>

                                    }

                                </div>
                            </div>
                            <!--end::Number-->
                            <!--begin::Label-->
                            <div class="fw-semibold fs-6 text-gray-500">Payments</div>
                            <!--end::Label-->
                        </div>
                        <!--end::Stat-->
                        <!--begin::Stat-->
                        <div class="border border-gray-300 border-dashed rounded min-w-125px py-3 px-4 me-6 mb-3">
                            <!--begin::Number-->
                            <div class="d-flex align-items-center">
                                <i class="fa-solid fa-file-invoice-dollar text-danger me-2"></i>
                                <div class="fs-4 fw-bold counted patient-current-balance" data-kt-countup="true" data-kt-countup-value=@Model.CurentBalance data-kt-countup-prefix="$" data-kt-initialized="1">
                                    <span id="CurrentBalance">@Model.CurentBalance</span> <span class="mx-2">LE</span>
                                    
                                </div>
                            </div>
                            <!--end::Number-->
                            <!--begin::Label-->
                            <div class="fw-semibold fs-6 text-gray-500">Amount to Pay</div>
                            <!--end::Label-->
                        </div>
                        <!--end::Stat-->
                    </div>
                    <!--end::Stats-->
                    <!--begin::Users-->
                    <div class="d-flex align-items-center flex-wrap mb-1">
                        <span class="badge badge-light-info patient-type me-2 mb-2">@Model.Gender</span>
                        <span class="badge badge-light-info patient-phone me-2 mb-2">@Model.PhoneNumber</span>
                        <span class="badge badge-light-info patient-occupation me-2 mb-2">@Model.Occupation</span>
                    </div>
                    <!--end::Users-->
                </div>
                <!--end::Info-->
            </div>
            <!--end::Wrapper-->
        </div>
        <!--end::Details-->

        <div class="separator"></div>

        <!--begin::Nav-->
        <ul class="nav nav-stretch nav-line-tabs nav-line-tabs-2x border-transparent fs-5 fw-bold">
            <!--begin::Nav item-->
            <li class="nav-item">
                <a class="nav-link text-active-primary py-5 me-6 active" data-bs-toggle="tab" href="#kt_tab_pane_3">
                    Prescriptions
                </a>
            </li>
            <!--end::Nav item-->
            <!--begin::Nav item-->
            <li class="nav-item">
                <a class="nav-link text-active-primary tab-plans-datatable py-5 me-6" data-bs-toggle="tab" href="#kt_tab_pane_1" onclick="datatable = datatablePlans;">
                    Treatment Plans
                </a>
            </li>
            <!--end::Nav item-->
            <!--begin::Nav item-->
            <li class="nav-item">
                <a class="nav-link text-active-primary tab-appointments-datatable py-5 me-6" data-bs-toggle="tab" href="#kt_tab_pane_2" onclick="datatable = datatableAppoinments;">
                    Reservations
                </a>
            </li>
            <!--end::Nav item-->
            <!--begin::Nav item-->
            <li class="nav-item">
                <a class="nav-link text-active-primary  py-5 me-6" data-bs-toggle="tab" href="#kt_tab_pane_4">
                    Medical Report
                </a>
            </li>
            <!--end::Nav item-->
            <!--begin::Nav item-->
            <li class="nav-item">
                <a class="nav-link text-active-primary tab-payments-datatable py-5 me-6" data-bs-toggle="tab" href="#kt_tab_pane_5">
                    Payments
                </a>
            </li>
            <!--end::Nav item-->
        </ul>
        <!--end::Nav-->
    </div>

</div>
<div class="tab-content py-4" id="myTabContent">
    <div class="tab-pane fade show active" id="kt_tab_pane_3" role="tabpanel">
        <div class="card pt-4 mb-6 mb-xl-9">
            <!--begin::Card header-->
            <div class="card-header border-0">
                <div class="d-flex flex-wrap flex-stack pt-3 pb-8 w-100">
                    <!--begin::Heading-->
                    <h3 class="fw-bold my-2">
                        Prescriptions
                    </h3>
                    <!--end::Heading-->
                    @if (await userManger.IsInRoleAsync(applicationUser, "Doctor"))
                    {
                        <!--begin::Filter-->
                        <a href="javascript:;" class="btn btn-sm btn-flex btn-light-primary js-create-prescription" data-url="/Prescription/Create/@Model.Id">
                            <i class="bi bi-plus-square-dotted"></i>
                            Add Prescription
                        </a>
                        <!--end::Filter-->
                    }

                </div>
            </div>
            <!--end::Card header-->
            <div class="card-body pt-0 pb-5">
                <!--begin::Row-->
                <div class="row g-9 prescription-container">
                    <!--begin::Col-->
                    <div class="alert alert-dismissible bg-light-primary  border border-primary  border-dashed d-flex flex-column flex-sm-row w-100 p-5 mb-10 empty-prescription-msg @(Model.Prescriptions.Count > 0 ? "d-none" : "")">
                        <div class="d-flex flex-column pe-0 pe-sm-10">
                            <h5 class="mb-1">There is no prescription yet</h5>
                            <span>This alert is appear when no data is creating in page.</span>
                        </div>
                        <!--end::Content-->
                        <!--begin::Close-->
                        <button type="button" class="position-absolute position-sm-relative m-2 m-sm-0 top-0 end-0 btn btn-icon ms-sm-auto" data-bs-dismiss="alert">
                            <i class="ki-duotone ki-cross fs-1 text-primary "><span class="path1"></span><span class="path2"></span></i>
                        </button>
                        <!--end::Close-->
                    </div>
                    @foreach (var prescription in Model.Prescriptions!)
                    {
                        <partial name="_Prescription" model="prescription" />

                    }

                    <!--end::Col-->
                </div>
                <!--end::Row-->
            </div>

        </div>
    </div>
    <div class="tab-pane fade" id="kt_tab_pane_1" role="tabpanel">

        <!--begin::Row-->
        <div class="row gy-5 g-xl-10" data-select2-id="select2-data-134-f91o">
            <!--begin::Col-->
            <div class="col-xl-4 mb-xl-10">

                <!--begin::Engage widget 1-->
                <div class="card h-md-100" dir="ltr">
                    <!--begin::Body-->
                    <div class="card-body d-flex flex-column flex-center">
                        <!--begin::Heading-->
                        <div class="mb-2">
                            @if (await userManger.IsInRoleAsync(applicationUser, "Doctor"))
                            {
                                <!--begin::Title-->
                                <h1 class="fw-semibold text-gray-800 text-center lh-lg">
                                    Hello<br> Are You Want New
                                    <span class="fw-bolder"> Plan ?</span>
                                </h1>
                                <!--end::Title-->
                            }
                            else
                            {
                                <!--begin::Title-->
                                <h1 class="fw-semibold text-gray-800 text-center lh-lg">
                                    Hello<br> Check Your
                                    <span class="fw-bolder">Treatment Plan</span>
                                </h1>
                                <!--end::Title-->
                            }
                            <!--begin::Illustration-->
                            <div class="py-10 text-center">
                                <img src="~/assets/images/plan.svg" class="theme-light-show w-200px" alt="">
                                <img src="~/assets/images/plan-dark.svg" class="theme-dark-show w-200px" alt="">
                            </div>
                            <!--end::Illustration-->
                        </div>
                        <!--end::Heading-->
                        <!--begin::Links-->
                        @if (await userManger.IsInRoleAsync(applicationUser, "Doctor"))
                        {
                            <div class="text-center mb-1">
                                <!--begin::Link-->
                                <a class="btn btn-sm btn-primary js-render-modal tab-plans-datatable" href="javascript:;" data-url="/TPlans/Create/@Model.Id" data-title="Add New TPlan">
                                    New Treatment Plan
                                </a>
                                <!--end::Link-->
                            </div>
                        }

                        <!--end::Links-->
                    </div>
                    <!--end::Body-->
                </div>
                <!--end::Engage widget 1-->

            </div>
            <!--end::Col-->
            <!--begin::Col-->
            <div class="col-xl-8 mb-5 mb-xl-10">

                <!--begin::Table Widget 4-->
                <div class="card card-flush h-xl-100">
                    <!--begin::Card header-->
                    <div class="card-header pt-7">
                        <!--begin::Card title-->
                        <div class="card-title">
                            <div class="d-flex align-items-center position-relative my-1">
                                <span class="svg-icon svg-icon-1 position-absolute ms-4">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect opacity="0.5" x="17.0365" y="15.1223" width="8.15546" height="2" rx="1" transform="rotate(45 17.0365 15.1223)" fill="currentColor"></rect>
                                        <path d="M11 19C6.55556 19 3 15.4444 3 11C3 6.55556 6.55556 3 11 3C15.4444 3 19 6.55556 19 11C19 15.4444 15.4444 19 11 19ZM11 5C7.53333 5 5 7.53333 5 11C5 14.4667 7.53333 17 11 17C14.4667 17 17 14.4667 17 11C17 7.53333 14.4667 5 11 5Z" fill="currentColor"></path>
                                    </svg>
                                </span>
                                <input type="text" data-kt-filter="search" class="form-control form-control-solid w-250px ps-14 js-search-plans" placeholder="Search..." />
                            </div>
                            <div id="kt_datatable_example_1_export" class="d-none"></div>
                        </div>
                        <!--end::Card title-->
                    </div>
                    <!--end::Card header-->
                    <!--begin::Card body-->
                    <div class="card-body pt-2">
                        <!--begin::Table-->
                        <div>
                            <div class="table-responsive">
                                <table id="kt_datatable_zero_configuration" class="js-datatable-plans table table-row-dashed table-row-gray-300 gy-3 align-middle">
                                    <thead>
                                        <tr class="fw-bold fs-6 text-gray-800">
                                            <th>Name</th>
                                            <th>Start</th>
                                            <th>End</th>
                                            <th>Status</th>
                                            <th class="text-center">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!--Data Generated Here-->
                                        @foreach (var plan in Model.Tplans)
                                        {
                                            <Partial name="_TPlan" model="plan" />
                                        }
                                    </tbody>

                                </table>
                            </div>
                        </div>
                        <!--end::Table-->
                    </div>
                    <!--end::Card body-->
                </div>
                <!--end::Table Widget 4-->
            </div>
            <!--end::Col-->
        </div>
        <!--end::Row-->
    </div>
    <div class="tab-pane fade" id="kt_tab_pane_2" role="tabpanel">
        
        <div class="card pt-4 mb-6 mb-xl-9">
            <!--begin::Card header-->
            <div class="card-header border-0">
                <!--begin::Card title-->
                <div class="card-title">
                    <div class="d-flex align-items-center position-relative my-1">
                        <span class="svg-icon svg-icon-1 position-absolute ms-4">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect opacity="0.5" x="17.0365" y="15.1223" width="8.15546" height="2" rx="1" transform="rotate(45 17.0365 15.1223)" fill="currentColor"></rect>
                                <path d="M11 19C6.55556 19 3 15.4444 3 11C3 6.55556 6.55556 3 11 3C15.4444 3 19 6.55556 19 11C19 15.4444 15.4444 19 11 19ZM11 5C7.53333 5 5 7.53333 5 11C5 14.4667 7.53333 17 11 17C14.4667 17 17 14.4667 17 11C17 7.53333 14.4667 5 11 5Z" fill="currentColor"></path>
                            </svg>
                        </span>
                        <input type="text" data-kt-filter="search" class="form-control form-control-solid w-250px ps-14 js-search-appointments" placeholder="Search..." />
                    </div>
                    <div id="kt_datatable_example_1_export" class="d-none"></div>
                </div>
                <!--end::Card title-->
            </div>
            <!--end::Card header-->
            <!--begin::Card body-->
            <div class="card-body pt-0 pb-5">
                <!--begin::Table-->
                <div>
                    <div class="table-responsive">
                        <table id="kt_datatable_zero_configuration" class="js-datatable-appointments table table-row-dashed table-row-gray-300 gy-3 align-middle">
                            <thead>
                                <tr class="fw-bold fs-6 text-gray-800">
                                    <th>Date</th>
                                    <th>Start Time</th>
                                    <th>End Time</th>
                                    <th>Status</th>
                                    <th class="text-center">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!--Data Generated Here-->
                                @foreach (var appointment in Model.Appointments)
                                {
                                    <tr>
                                        <td>@appointment.Start.ToString("ddd dd MMM yy")</td>
                                        <td>
                                            <span class="badge badge-light-info">@appointment.StartTime</span>
                                        </td>
                                        <td>
                                            <span class="badge badge-light-info">@appointment.EndTime</span>
                                        </td>
                                        <td>
                                            @{
                                                DateOnly today = DateOnly.FromDateTime(DateTime.Today);
                                                TimeOnly time = TimeOnly.FromDateTime(DateTime.Now);
                                                DateTime dt1 = DateTime.Parse(appointment.Start.ToString()).Date;
                                                DateTime dt2 = DateTime.Parse(today.ToString()).Date;
                                                int result = DateTime.Compare(dt1, dt2);
                                                if (result > 0 || (result == 0 && appointment.StartTime.CompareTo(time) >= 0))
                                                {
                                                    <span class="badge badge-light-success">upcomming</span>

                                                }
                                                else
                                                {
                                                    <span class="badge badge-light-danger">previous</span>
                                                }
                                            }
                                        </td>
                                        <td class="text-center">
                                            <a href="#" class="btn btn-light btn-active-light-primary btn-flex btn-center btn-sm" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">
                                                Actions
                                                <span class="svg-icon svg-icon-muted svg-icon-5">
                                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                        <path d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z" fill="currentColor" />
                                                    </svg>
                                                </span>
                                            </a>
                                            <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-semibold fs-7 w-125px py-4" data-kt-menu="true" style="">
                                                <div class="menu-item px-3">
                                                    <a href="javascript:;" class="menu-link px-3 js-show-prescription" data-url="/Prescription/ReservationPrescription/@appointment.Id">
                                                        Prescription
                                                    </a>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                }
                            </tbody>

                        </table>
                    </div>
                </div>
                <!--end::Table-->
            </div>
            <!--end::Card body-->
        </div>



    </div>
    <div class="tab-pane fade" id="kt_tab_pane_4" role="tabpanel">
        <div class="card pt-4 mb-6 mb-xl-9">
            <!--begin::Card header-->
            <div class="card-header border-0">
                <div class="d-flex flex-wrap flex-stack pt-3 pb-8 w-100">
                    <!--begin::Heading-->
                    <h3 class="fw-bold my-2">
                        Medical History
                    </h3>
                    <!--end::Heading-->
                    @if (await userManger.IsInRoleAsync(applicationUser, "Doctor"))
                    {
                        <!--begin::Filter-->
                        <button type="button" class="btn btn-sm btn-flex btn-light-primary js-render-modal" data-title="Add New Report" data-url="/MedicalReports/Create/@Model.Id" data-box="true">
                            <i class="bi bi-plus-square-dotted"></i>
                            Add Report
                        </button>
                        <!--end::Filter-->
                    }

                </div>
            </div>
            <!--end::Card header-->
            <div class="card-body pt-0 pb-5">
                <!--begin::Row-->
                <div class="row g-9 reports-container">
                    <!--begin::Col-->
                    <div class="alert alert-dismissible bg-light-primary  border border-primary  border-dashed d-flex flex-column flex-sm-row w-100 p-5 mb-10 empty-report-msg @(Model.MedicalHistories.Count > 0 ? "d-none" : "")">
                        <div class="d-flex flex-column pe-0 pe-sm-10">
                            <h5 class="mb-1">There is no Medical Report yet</h5>
                            <span>This alert is appear when no data is creating in page.</span>
                        </div>
                        <!--end::Content-->
                        <!--begin::Close-->
                        <button type="button" class="position-absolute position-sm-relative m-2 m-sm-0 top-0 end-0 btn btn-icon ms-sm-auto" data-bs-dismiss="alert">
                            <i class="ki-duotone ki-cross fs-1 text-primary "><span class="path1"></span><span class="path2"></span></i>
                        </button>
                        <!--end::Close-->
                    </div>

                    @foreach (var medicalHistory in Model.MedicalHistories!)
                    {
                        <partial name="_MdeicalReport" model="medicalHistory" />

                    }

                    <!--end::Col-->
                </div>
                <!--end::Row-->
                <!-- light box overlay -->
                <div class="lightBox-overlay d-none justify-content-center align-items-center">
                    <a href="javascript:;" class="lightbox-arrow lightbox-arrow-left">
                        <i class="fa-solid fa-chevron-left"></i>
                    </a>
                    <div class="image-center-container d-flex flex-column align-items-center">
                        <img class="image-center" src="" alt="center">
                    </div>
                    <a href="javascript:;" class="lightbox-arrow lightbox-arrow-right">
                        <i class="fa-solid fa-chevron-right"></i>
                    </a>
                </div>

            </div>

        </div>
    </div>
    <div class="tab-pane fade" id="kt_tab_pane_5" role="tabpanel">
        <!--begin::Row-->
        <div class="row gy-5 g-xl-10" data-select2-id="select2-data-134-f91o">
            <!--begin::Col-->
            <div class="col-xl-4 mb-xl-10">

                <!--begin::Engage widget 1-->
                <div class="card h-md-100" dir="ltr">
                    <!--begin::Body-->
                    <div class="card-body d-flex flex-column flex-center">
                        <!--begin::Heading-->
                        <div class="mb-2">
                            <!--end::Heading-->
                            @if (await userManger.IsInRoleAsync(applicationUser, "Doctor"))
                            {
                                <!--begin::Title-->
                                <h1 class="fw-semibold text-gray-800 text-center lh-lg">
                                    Hello<br> Are You Want New
                                    <span class="fw-bolder"> Payment ?</span>
                                </h1>
                                <!--end::Title-->
                            }
                            else
                            {
                                <!--begin::Title-->
                                <h1 class="fw-semibold text-gray-800 text-center lh-lg">
                                    Hello<br> Check Your 
                                    <span class="fw-bolder"> Payment</span>
                                </h1>
                                <!--end::Title-->
                            }

                            <!--begin::Illustration-->
                            <div class="py-10 text-center">
                                <img src="~/assets/images/plan.svg" class="theme-light-show w-200px" alt="">
                                <img src="~/assets/images/plan-dark.svg" class="theme-dark-show w-200px" alt="">
                            </div>
                            <!--end::Illustration-->
                        </div>
                        <!--end::Heading-->
                        <!--begin::Links-->
                        <div class="text-center mb-1">
                            <!--end::Heading-->
                            @if (await userManger.IsInRoleAsync(applicationUser, "Doctor"))
                            {
                                <!--begin::Link-->
                                <a class="btn btn-sm btn-primary js-render-modal" data-url="/Payments/Create/@Model.Id" data-title="Add New Payment">
                                    New Payment Record
                                </a>
                                <!--end::Link-->
                            }

                        </div>
                        <!--end::Links-->
                    </div>
                    <!--end::Body-->
                </div>
                <!--end::Engage widget 1-->

            </div>
            <!--end::Col-->
            <!--begin::Col-->
            <div class="col-xl-8 mb-5 mb-xl-10">

                <!--begin::Table Widget 4-->
                <div class="card card-flush h-xl-100">
                    <!--begin::Card header-->
                    <div class="card-header pt-7">
                        <!--begin::Card title-->
                        <div class="card-title">
                            <div class="d-flex align-items-center position-relative my-1">
                                <span class="svg-icon svg-icon-1 position-absolute ms-4">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect opacity="0.5" x="17.0365" y="15.1223" width="8.15546" height="2" rx="1" transform="rotate(45 17.0365 15.1223)" fill="currentColor"></rect>
                                        <path d="M11 19C6.55556 19 3 15.4444 3 11C3 6.55556 6.55556 3 11 3C15.4444 3 19 6.55556 19 11C19 15.4444 15.4444 19 11 19ZM11 5C7.53333 5 5 7.53333 5 11C5 14.4667 7.53333 17 11 17C14.4667 17 17 14.4667 17 11C17 7.53333 14.4667 5 11 5Z" fill="currentColor"></path>
                                    </svg>
                                </span>
                                <input type="text" data-kt-filter="search" class="form-control form-control-solid w-250px ps-14 js-search-payments" placeholder="Search..." />
                            </div>
                            <div id="kt_datatable_example_1_export" class="d-none"></div>
                        </div>
                        <!--end::Card title-->
                    </div>
                    <!--end::Card header-->
                    <!--begin::Card body-->
                    <div class="card-body pt-2">
                        <!--begin::Table-->
                        <div>
                            <div class="table-responsive">
                                <table id="kt_datatable_zero_configuration" class="js-datatable-payments table table-row-dashed table-row-gray-300 gy-3 align-middle">
                                    <thead>
                                        <tr class="fw-bold fs-6 text-gray-800">
                                            <th>Date</th>
                                            <th>Operation</th>
                                            <th>Value</th>
                                            <th class="text-center">Note</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var paymentRecord in Model.PaymentRecords)
                                        {
                                            <partial name="_Payment" model="paymentRecord" />
                                        }
                                    </tbody>

                                </table>
                            </div>
                        </div>
                        <!--end::Table-->
                    </div>
                    <!--end::Card body-->
                </div>
                <!--end::Table Widget 4-->
            </div>
            <!--end::Col-->
        </div>
        <!--end::Row-->
    </div>
</div>
<div class="modal fade" id="Modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered mw-650px">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="ModalLabel"></h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!--Generated By Javascript-->
            </div>
        </div>
    </div>
</div>
<!--Start::Appointments Modal-->
<!-- Modal -->
<div class="modal fade" id="reserveAppointment" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-fullscreen">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Reserve Appointment</h1>
                <button type="button" class="btn-close" onclick="location.reload()" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-12 col-xl-4">
                        <div class="card mb-5 mb-xl-8" style="box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 6px -1px, rgba(0, 0, 0, 0.06) 0px 2px 4px -1px;">
                            <!--begin::Card body-->
                            <div class="card-body pt-15">
                                <!--begin::Summary-->
                                <div class="d-flex flex-center flex-column mb-5">
                                    <!--begin::Avatar-->
                                    <div class="symbol symbol-100px symbol-circle mb-7">
                                        <img class="patient-image img-thumbnail" src="~/assets/images/user.jpg" alt="image">
                                    </div>
                                    <!--end::Avatar-->
                                    <!--begin::Name-->
                                    <a href="#" class="fs-3 text-gray-800 text-hover-primary fw-bold mb-1 patient-name">

                                    </a>
                                    <!--end::Name-->
                                    <!--begin::Position-->
                                    <div class="fs-5 fw-semibold text-muted mb-6 patient-phone">
                                    </div>
                                    <!--end::Position-->
                                    <!--begin::Info-->
                                    <div class="d-flex flex-center">
                                        <!--begin::Stats-->
                                        <div class="border border-gray-300 border-dashed rounded py-3 px-3 mb-3">
                                            <div class="fs-4 fw-bold text-gray-700 text-center">
                                                <span class="w-75px upcoming-appointments text-center">5</span>
                                            </div>
                                            <div class="fw-semibold text-primary">Upcomming</div>
                                        </div>
                                        <!--end::Stats-->
                                        <!--begin::Stats-->
                                        <div class="border border-gray-300 border-dashed rounded py-3 px-3 mx-4 mb-3">
                                            <div class="fs-4 fw-bold text-gray-700 text-center">
                                                <span class="w-50px prev-appointments text-center">10</span>
                                            </div>
                                            <div class="fw-semibold text-danger">Previous</div>
                                        </div>
                                        <!--end::Stats-->
                                    </div>
                                    <!--end::Info-->
                                </div>
                                <!--end::Summary-->
                                <!--begin::Details content-->
                                <div id="kt_customer_view_details" class="collapse show">
                                    <div class="separator separator-dashed my-3"></div>
                                    <h4>Reservations</h4>
                                    <div class="reservedAppointments-list d-flex flex-wrap">
                                    </div>
                                </div>
                                <!--end::Details content-->

                            </div>
                            <!--end::Card body-->
                        </div>
                    </div>
                    <div class="col-12 col-xl-8">
                        <div class="date-filter">
                            <div class="mb-3">
                                <div class="form-floating" style="width:300px;">
                                    <input id="DateFilter" type="date" class="form-control appointment-date-filter" name="appointment_filter" placeholder="day..." />
                                    <label class="form-label">Date</label>
                                </div>
                            </div>
                        </div>
                        <div class="appointment-box d-flex flex-wrap" style="max-height:700px; overflow-y:auto;">
                            <!--Appointment genderated here by javascript patient-->
                        </div>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn-sm btn btn-secondary" onclick="location.reload()" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn-sm btn btn-primary me-2 js-reserve-appointment-patient" data-appointment="" data-patient="">
                    <span class="indicator-label">
                        Reserve Appointment
                    </span>
                    <span class="indicator-progress">
                        Please wait... <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>
<!--End::Appointments Modal-->
<input type="hidden" name="__RequestVerificationToken" value="@antiforgery.GetAndStoreTokens(Context).RequestToken" id="tokkenForgery" />



@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="~/assets/Plugins/datatables/datatables.bundle.js"></script>
    <script src="~/js/patientDetails.js" asp-append-version="true"></script>
   
}